!function(root,factory){"undefined"!=typeof exports?"undefined"!=typeof module&&(exports=module.exports=factory(root,exports)):"function"==typeof define&&define.amd?define(["exports"],function(exports){root.BoomerangCache=factory(root,exports)}):root.BoomerangCache=factory(root,{})}(this,function(){"use strict";function BoomerangCache(store,options){if(this.options=options,this.storage=this.api[this.options.storage],"undefined"==typeof this.storage)throw"Undefined factory";this.storage.check()&&(this.namespace=""!=utils.trim(store)?utils.trim(store):"BoomerangCache")}var api,utils,expirePrefix;return expirePrefix="__boomerangExpire__",BoomerangCache.prototype.hasExpired=function(key){var expireKey=utils.expireKey(this.namespace,key),expireValue=parseInt(this.storage.getItem(expireKey),10);return!!(expireValue&&expireValue<utils.currentTime())},utils=function(){return{extend:function(){for(var i=1;i<arguments.length;i++)for(var key in arguments[i])arguments[i].hasOwnProperty(key)&&(arguments[0][key]=arguments[i][key]);return arguments[0]},trim:function(x){return x.replace(/^\s+|\s+$/gm,"")},namespaceKey:function(namespace,key){return namespace+":"+key},expireKey:function(namespace,key){return this.namespaceKey(namespace,expirePrefix+key)},currentTime:function(){return(new Date).getTime()}}}(),api=function(){var instance;return{create:function(store,options){var defaultOptions={storage:"local"};return options=utils.extend(defaultOptions,options),instance=new BoomerangCache(store,options)}}}(),BoomerangCache.prototype.api={local:{check:function(){var key="__BoomerangCache__",value="BoomerangCache";try{return localStorage.setItem(key,value),localStorage.removeItem(key),!0}catch(exc){return console.log("error"),!1}},getItem:function(key){return localStorage.getItem(key)},setItem:function(key,value){localStorage.removeItem(key),localStorage.setItem(key,value)},getAll:function(namespace){for(var keys=Object.keys(localStorage),values={},i=keys.length;i--;){var keySplit=keys[i].split(":");keySplit[0]==namespace&&(values[keySplit[1]]=localStorage.getItem(keys[i]))}return values},getObject:function(key){var obj=localStorage.getItem(key);return JSON.parse(obj)},setObject:function(key,value){localStorage.removeItem(key),localStorage.setItem(key,JSON.stringify(value))},removeItem:function(key){return localStorage.removeItem(key)},clear:function(){localStorage.clear()}},session:{check:function(){var key="__BoomerangCache__",value="BoomerangCache";try{return sessionStorage.setItem(key,value),sessionStorage.removeItem(key),!0}catch(exc){return console.log("error"),!1}},getItem:function(key){return sessionStorage.getItem(key)},setItem:function(key,value){sessionStorage.removeItem(key),sessionStorage.setItem(key,value)},getAll:function(namespace){for(var keys=Object.keys(sessionStorage),values={},i=keys.length;i--;){var keySplit=keys[i].split(":");keySplit[0]==namespace&&(values[keySplit[1]]=sessionStorage.getItem(keys[i]))}return values},getObject:function(key){var obj=sessionStorage.getItem(key);return JSON.parse(obj)},setObject:function(key,value){sessionStorage.removeItem(key),sessionStorage.setItem(key,JSON.stringify(value))},removeItem:function(key){return sessionStorage.removeItem(key)},clear:function(){sessionStorage.clear()}}},BoomerangCache.prototype.set=function(key,value,seconds){var namespaceKey=utils.namespaceKey(this.namespace,key),expireKey=utils.expireKey(this.namespace,key);if(seconds){var s=1e3*seconds;this.storage.setItem(expireKey,utils.currentTime()+s)}else this.storage.removeItem(expireKey);return"undefined"==typeof value?this.storage.removeItem(namespaceKey):"object"==typeof value?(this.storage.setObject(namespaceKey,value),value):(this.storage.setItem(namespaceKey,value),value)},BoomerangCache.prototype.get=function(key,defaultValue){var namespaceKey=utils.namespaceKey(this.namespace,key);if(this.hasExpired(key))return this.storage.removeItem(namespaceKey),this.storage.removeItem(utils.expireKey(this.namespace,key)),null;var value=this.storage.getItem(namespaceKey);if("undefined"!=typeof value||null!=value)try{return JSON.parse(value)}catch(e){}return"undefined"!=typeof value?value:defaultValue},BoomerangCache.prototype.getAll=function(){return this.storage.getAll(this.namespace)},BoomerangCache.prototype.remove=function(key){return key=utils.namespaceKey(this.namespace,key),this.storage.removeItem(key)},BoomerangCache.prototype.length=function(){return Object.keys(this.storage.getAll(this.namespace)).length},BoomerangCache.prototype.clear=function(){this.storage.clear()},BoomerangCache.prototype.check=function(){return this.storage.check()},api});
//# sourceMappingURL=boomerang-cache.map